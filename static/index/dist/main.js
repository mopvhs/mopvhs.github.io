define("shadow/index/1.0.0/main",["jquery","cookie","tabs","dialog"],function(a){var b=a("jquery"),c=a("cookie"),d="http://www.tulongzhiji.com/meal/",e="production";location.href.indexOf("?dev")>0&&(e="development",d="http://meal-dev.mopvhs.com/"),"development"==e?b(".environment-status").html("开发模式"):b(".environment-status").html("线上模式");var f=a("tabs"),g=a("dialog");tabs=new f({element:"#tab-demo-1",triggers:".ui-switchable-nav li",panels:".ui-switchable-content .hidden",activeIndex:0,effect:"none",activeTriggerClass:"ui-tab-item-current"}),b("#login-btn").click(function(a){a.preventDefault();var e=b("#login-form").serialize(),f=b.ajax({url:d+"api/login",type:"POST",data:e,dataType:"jsonp"});f.done(function(a){a.success?(c.set("auth_str",a.auth_str,{domain:"github.io",path:"/",expires:30}),window.location.reload()):new g({content:'<div style="padding:50px">'+a.message+"</div>"}).show()}),f.fail(function(a,b){new g({content:'<div style="padding:50px">请求失败，'+b+"，请刷新页面重试！</div>"}).show()})}),b("#register-btn").click(function(a){a.preventDefault();var e=b("#register-form").serialize(),f=b.ajax({url:d+"api/register",type:"POST",data:e,dataType:"jsonp"});f.done(function(a){a.success?(c.set("auth_str",a.auth_str,{domain:"github.io",path:"/",expires:30}),window.location.reload()):new g({content:'<div style="padding:50px">'+a.message+"</div>"}).show()}),f.fail(function(a,b){new g({content:'<div style="padding:50px">请求失败，'+b+"，请刷新页面重试！</div>"}).show()})});var h=c.get("auth_str"),i=b.ajax({url:d+"api/initialize",type:"POST",data:{auth_str:h},dataType:"jsonp"});i.done(function(a){if(a.success){b(".user-status").html(a.email);var c="";a.judge>6&&a.judge<18?(b(".subitem-day").addClass("ui-nav-subitem-current"),c="&#xf0205;"):(b(".subitem-night").addClass("ui-nav-subitem-current"),c="&#xf01e4;"),b(".top-show .logo .iconfont").html(c)}else b("#login-box").show()}),i.fail(function(){b(".user-status").html("无法连接服务器")}),window.console&&console.log&&console.log(b.fn.jquery)});
